## 灰色模型时间序列预测

灰度模型可以在数据量很少的情况下对时间序列进行建模一般4-5个数据点就可以了。

---

### 数据的生成

1.累加生产（AGO）

​	设原始序列为$x^{(0)} = （x^0(1),x^0(2),x^0(3),\dots x^0(n)）$,令
$$
x^{(1)}(k)=\sum_{i=1}^{k} x^0(i) ,k = 1,2,3\dots n.
$$
生产数列$x^{(1)} = （x^1(1),x^1(2),x^1(3),\dots x^1(n)$生成数列为$x^{(0)}$的一次累加同理也可以定义$x^{(0)}$的r次累加
$$
x^{(r)}(k)=\sum_{i=1}^{k} x^{(r-1)}(i) ,k = 1,2,3\dots n.
$$
2.累减生成（IAGO）

​	若原始序列为$x^{(1)} = (x^1(1),x^1(2),x^1(3)\dots x^1(n))$,令$x^0(k) = x^1(k)-x^1(k-1)$,则称所得数列$x^{(0)}$为$x^{(1)}$的累减生成数列，通过累减数列可以还原出累加数列的原始数列

3.加权临值生成

​	若原始序列为$x^{(0)} = （x^0(1),x^0(2),x^0(3),\dots x^0(n)）$,任意一相邻元素$x^0(k)$,$x^0(k-1)$互为临值，对于常数$\alpha\in[0,1]$,有$z{(0)} = \alpha x^{(0)}(k)+(1-\alpha)x^{(0)}(k-1),k = 2,3,4\dots n$,$\alpha$称为生成系数

---

### 灰色模型GM(1,1)

​	我们定义$x^{(1)}$的灰导数为$$d(k) = x^0(k) = x^1(k)-x^1(k-1)$$

​	定义$z^{(1)}(k)$为数列$x^{(1)}(k)$的邻值生成数列$z^{(1)}(k) = \alpha x^{(1)}(k)+(1-\alpha)x^{(1)}(k-1),k = 2,3,4\dots n$

​	我们定义GM(1,1)灰微分方程模型为$d(k)+\alpha z^{(1)}(k) = b$或$x^0(k)+\alpha z^{(1)}(k) = b$其中$x^0(k)$称为灰导数，$\alpha$称为发展系数，$z^{(1)}(k)$称为白化背景值，$b$称为灰作用量。

将时刻k = 2,3,4,...n。带入模型公式
$$
\begin{cases}
x^0(2)+\alpha z^{(1)}(2) = b  \\
x^0(3)+\alpha z^{(3)}(k) = b  \\
\dots  \\
x^0(n)+\alpha z^{(n)}(k) = b
\end{cases}
$$
​	令$u = \begin{bmatrix}a\\b \end{bmatrix}$,$Y = \begin{bmatrix} x^0(2) \\x^0(3)\\ \dots \\x^0(n)\end{bmatrix}$,$B = \begin{bmatrix}-z^0(2) &1 \\ -z^0(3) &1 \\ \dots\\-z^0(n) &1 \\\end{bmatrix}=\begin{bmatrix}-\frac{1}{2}(x^{(1)}(1)+x^{(1)}(2))&1\\  -\frac{1}{2}(x^{(1)}(2)+x^{(1)}(3))&1\\ \cdots\\ -\frac{1}{2}(x^{(1)}(n-1)+x^{(1)}(n))&1\\\end{bmatrix}$,于是GM(1,1)模型可以表示为$Y = Bu$

​	利用最小二乘法求得$\hat u = \begin{bmatrix}\hat a\\\hat b \end{bmatrix}=\left(B^TB\right)^{-1}B^TY$

---

### GM(1,1)白化模型

​	对于GM（1,1）的灰微分方程，如果将时刻k=2,3,…,n视为连续变量t，则之前的$x^{(1)}$视为时间t函数，于是灰导数$x^{(0)}(k)$变为连续函数的导数$\frac{dx^{(1)}(t)}{dt} $,白化背景值$z^{(1)}(k)$对应于导数$x^{(1)}(t)$。于是GM（1,1）的灰微分方程对应于的白微分方程为:
$$
\frac {dx^{(1)}(t)}{dt}+\alpha x^{(1)}(t)=b
$$

---

### 预测条件&前期处理

- 原始数据应均为非负值，若存在负值应该做适当的平移变换

- 设原始数列为$x^{(0)} = (x^0(1),x^0(2),x^0(3),\dots x^0(n))$  ，定义数列的级比
  $$
  \lambda(k) = \frac{x^{(0)}(k-1)}{x^{(0)}(k)}, \qquad k =2,3,4\dots n
  $$
  如果所有的级比都落在可容覆盖区间$X = (e^{\frac{-2}{n+1}},e^{\frac{2}{n+1}})$内则数列$x^{(0)}$可以进行灰度预测，否则应该对数列进行适当的变换处理如

$$
y^{(0)}(k) =x^{(0)}(k) +c
$$

---

### 模型建求解

​	若$x^{(0)}$满足上诉条件，建立GM(1,1)模型$x^0(k)+\alpha z^{(1)}(k) = b$并求得$\alpha,b$ 求出其离散解为
$$
\hat{x}^{(1)}(k+1) = (x^{(0)}(1)- \frac{b}{\alpha}) e^{-\alpha b}+ \frac{b}{\alpha} \quad k=2,3,4\cdots n.
$$
从而得到相应的预测值$\hat{x}^{(0)} = \hat{x}^{(1)}(k+1)-\hat{x}^{(1)}(k),\quad k = 1,2,3\cdots n$	

---

### 预测效果检验

1. **残差检验**

   ​	
   $$
   \varepsilon(k) = \frac{x^{(0)}(k)-\hat{x}^{(0)}(k)}{x^{(0)}(k)}
   $$
   若$|\varepsilon(k)|<0.1$则达到较高要求,$|\varepsilon(k)|<0.2$合格

2. **级比偏差值检验**

   
   $$
   \rho(k) = 1-\frac{1-0.5\alpha}{1+0.5\alpha}\lambda(k)
   $$
   若$|\rho(k)|<0.1$ 则达到较高要求$|\rho(k)|<0.2$ 合格

   

​	





​	

.